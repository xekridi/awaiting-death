{# archives/templates/dashboard.html #}
{% extends "base.html" %}
{% load humanize %} {# timeuntil → «через 2 дня» #}

{% block content %}
<h1 class="text-xl font-semibold mb-6">Мои архивы</h1>

<table class="w-full text-sm">
    <thead>
        <tr class="border-b">
            <th class="py-2 text-left">Код</th>
            <th class="py-2 text-left">Файлов</th>
            <th class="py-2 text-left">Скачиваний</th>
            <th class="py-2 text-left">Удалится</th>
            <th class="py-2"></th>
        </tr>
    </thead>
    <tbody>
        {% for archive in archives %}
        <tr class="border-b hover:bg-gray-50">
            <td class="py-2 font-mono">{{ archive.short_code }}</td>
            <td class="py-2">{{ archive.files.count }}</td>
            <td class="py-2">{{ archive.download_count }}/{{ archive.max_downloads|default:"∞" }}</td>
            <td class="py-2">
                {% if archive.expires_at %}
                {% if archive.expires_at < now %} <span class="text-red-600">удалён</span>
                    {% else %}
                    через {{ archive.expires_at|timeuntil }}
                    {% endif %}
                    {% else %}
                    —
                    {% endif %}
            </td>
            <td class="py-2">
                <a href="{% url 'download' code=archive.short_code %}" class="text-blue-600 hover:underline">скачать</a>
            </td>
        </tr>
        {% empty %}
        <tr>
            <td colspan="5" class="py-4 text-center">Архивов пока нет</td>
        </tr>
        {% endfor %}
    </tbody>
</table>
{% endblock %}